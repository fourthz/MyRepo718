---
title:  "EDRM 718 Sp21: Exercise Set C"
author:  "Geophrey O. Odero"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_notebook
---


```{r include=FALSE}
# these libraries are good when it comes to plots and data manipulation

if(!require(devtools)) install.packages("devtools")
library(tidyverse)
library(here)
library(plyr)
library(gtools)
library(ggplot2)
library(cowplot)
library(rlang)
library(ggpubr)
library(tibble)
```



*****
**Directions:** _:Complete this assignment in an R notebook. Make sure to number each item, but it is optional for you to copy the prompt for the item. Make sure that your notebook is neat and organized and that all your code chunks run without error, even after clearing the environment. Include both the exercise set letter and your name in your notebook filename. When you are finished, push your repository to GitHub. (Four points per item unless stated otherwise.)_


*****


```{r}
# Load data--------------

# hsb2 <- read.csv(here("Data", "hsb2.csv"))

hsb2 <- read.csv("C:/Jeff/Github/Edrm718Sp21/Data/hsb2.csv")
```

*****

Question #1). **Create a list, my.courses, that contains three vectors: one with the numbers (e.g. EDRM 718) of the courses you are taking this semester, one with the names of the instructors of these courses (in order), and one with the credits you’ll earn in the course (again, in order).**


```{r}

# We can use the list function to create a list.

my_courses <- list(c("EDRM 718", "EDRM 728","EDRM 816"),
                   c("Mike Seaman", "C.Distefano", "Liu Steven"),
                   c("3 Credit hrs", "3 Credit hrs", "3 Credit hrs"))

my_courses
```

*****


QUestion #2). **Use the HSB2 data. Store test score matrices (include all five test scores) by SES in a list. Your matrix names should be indicative of SES level so that when you look at the list you can tell which matrix corresponds to each SES level. Once your list is set up, use it to plot the relationship of math score (response variable, so placed in the vertical direction) to reading score (explanatory variable) for each SES level. Make sure to label your axes. Also provide a title that clearly identifies each plot. Your plot should also include text that provides the correlation among the variables. (Note: Your script should make this automatic. You should not have to change the script when the correlation changes.) (25 points)**


```{r}
# 
cols <- c(4, 7:11)
hsb2_scores_data<-hsb2[,cols]
hsb2_scores_data$ses<- as.factor(hsb2_scores_data$ses)
hsb2_scores_data$ses<- ordered(hsb2_scores_data$ses,levels = c(1,2,3),
labels = c("Low", "Medium", "High"))

scores_data <- split(hsb2_scores_data, hsb2_scores_data$ses)

# Want plots in 2 rows ans one column

par(mfrow = c(1, 2))


p_1<-ggscatter(scores_data$Low, x = "read", y = "math", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "reading", ylab = "math",main="Math vs Reading(Low Ses)")

p_2<-ggscatter(scores_data$Medium, x = "read", y = "math", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "reading", ylab = "math",main="Math vs Reading(Medium Ses)")

p_3<-ggscatter(scores_data$High, x = "read", y = "math", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "reading", ylab = "math",main="Math vs Reading(High Ses)")

plot_grid(p_1,p_2,p_3, ncol =2, nrow =2)
```

*****

Question #3). **Use the sample function to randomly select three classmates. Consider these classmates and  yourself as a learning group of four students. Create a data frame for your learning group that includes the following variables: first name, last name, email address, program of study, number of years in current program of study. (You can email your selected classmates for this information. You will find email addresses on a previous Research Café post.) After the data frame is created, add two more variables: one that is the name again, but in “first name, last name” format (this variable should be created from your original data frame and should be placed right after the first name and last name variables) and a logical (also created from existing data and not “by hand”) to indicate whether the group member has been in their program of study more than three years. (10 points) **

```{r}
sample (c("Cade, Abrams","Talal, Alshehri","Ali, Azughaibi", "Hazza, Bin Hazza",
          "Asiye, Demir","Shelby, Gonzales","Hui, Jiang", "Olivia, Lewis",
         "Robyn, Pernetti","Mohammed, Quasem","Dana, Sox","Bryan, Terlizzi",
          "Thomas, Toomey","Huijuan, Wang","Erin, Wilson"),
        size=3, replace =F)


first_name<- c("Bryan", "Geophrey", "Hazza", "Olivia")
last_name<- c("Terlizzi","Odero","Bin Hazza","Lewis")
email_address<-c("terlizzb@email.sc.edu","godero@mailbox.sc.edu",
                 "BINHAZZA@email.sc.edu","oliviaLEWIS@email.sc.edu")
program_type<-c("Physical Education(PhD)","Edrm (PhD)"," Language and Literacy(PhD)",
                "Counseling and PE(PhD)")
num_years<-c(2,3,1,2)
learn_group_data <- data.frame(first_name,last_name,email_address,program_type,num_years)
learn_group_data<-as_tibble(learn_group_data)
learn_group_data
# New column vector

full_name<- c("Bryan Terlizzi","Geophrey Odero","Hazza Bin Hazza","Olivia Lewis")

 # Apply add_column function by name

Learn_group_new<-add_column(learn_group_data, full_name, .after = "last_name") 
Learn_group_new<-as_tibble(Learn_group_new)
Learn_group_new
mutate(Learn_group_new, Greater.than3years= ifelse(num_years>3, "Yes", "No"))
```

*****

QUestion#4). **Select either (a) or (b) for this exercise., depending on whether you are familiar with analysis of variance with a categorical explanatory variable.**

(a). **Write a script to conduct an analysis of variance to determine if you can infer different score means for the three different grade levels at Mount Juniper Elementary. (Caution: Look at the degrees of freedom for grade level to make certain you are doing this correctly.)**

```{r}
# (a) Load data------------

Mt_Juniper_data <- read.csv("C:/Jeff/Github/Edrm718Sp21/Exercise Sets/Data/Mt_Juniper_data.csv")
# Lets visualize the data

#boxplot(Mt_Juniper_data$Score~Mt_Juniper_data$Grade,xlab = "Grade",ylab = "Score")

```






(b) **Write a script that will create a subset with only grades four and five from the Mount Juniper Elementary data, then conduct at test to determine if you can infer different score means for these two grade levels.**

```{r}
# creating subsets of grade 4 and grade 5 only

Mt_Juniper_Grade<- subset(Mt_Juniper_data, Grade != "3")

# Lets visualize the two grade levels by looking at side-by-side boxplots

boxplot(Mt_Juniper_Grade$Score~Mt_Juniper_Grade$Grade,xlab = "Grade",ylab = "Score")
```

```{r}
# Lets run a t-test

t_results<-t.test(Mt_Juniper_Grade$Score~Mt_Juniper_Grade$Grade)
t_results
```

_The p-value of the test is 0.6802, which is greater than the significance level alpha = 0.05. Fail to reject $H_0$. We can conclude that mean of scores for grade 4 is not significantly different from mean of scores for grade 5.  The 95\% confidence interval contains zero implying no significant difference._


*****


Question #5). **Use the HSB2 data to illustrate how each member of the apply family works. Do this by selecting the correct family member to accomplish each of the following tasks for the five test scores (not the entire data set). Make sure to use each family member one time, and only one time. (10 points)**

```{r}
# choosing variables of interest

cols1<- c(5, 7:11)
test_scores_data<-hsb2[,cols1]
test_scores_data$schtyp<- as.factor(test_scores_data$schtyp)
test_scores_data$schtyp<- ordered(test_scores_data$schtyp,levels = c(1,2),
labels = c("public", "private"))

test_scores_data
```

a). **Put the standard deviation (SD) of each test as an element in a list of the five SDs.**

```{r}
# lapply: apply a fxn to each element and obtain a list

List_SDs<-lapply(test_scores_data[,2:6],sd )
List_SDs
```

*****

b). **Create a vector of SDs for the five tests.**

```{r}
# We use sapply: same as lapply but returns a vector

new_test_scores<-test_scores_data[,-1]
new_test_scores
vec_scores<-sapply(new_test_scores, sd)
vec_scores

# check if it returns a vector

is.vector(vec_scores)
```



*****

c).**Create a vector of the standard deviation of the five test scores for each student in the sample.**

```{r}
# summarize the data  by finding the statistics of each row or column

stud_scores_sd<-apply(new_test_scores,1,sd)
stud_scores_sd

# check if it is a vector

is.vector(stud_scores_sd)
```


*****


d). Obtain SDs for the five tests by school type (i.e., public or private)


```{r}
# tapply-create data with an factor for indexing
# We use aggregate()-can be thought as a generalization of tapply()

aggregate(test_scores_data[,2:6],by=list(test_scores_data$schtyp), sd)

```

*****

Question #6). **Construct a vector of any nine different numbers between 0 and 100. Next, add two missing indicators to your vector, somewhere mixed in among the numbers. Now add infinity to your vector, again anywhere within the vector. You should now have a vector of length 12. Use your vector to demonstrate, with explanation, all possible arguments for the range function. If the range function can be used on more types of data than numeric, also construct additional vectors to demonstrate all possible uses of the range function. (13 points)**

```{r}
# Get a vector of 9 numbers from 0 to 100

my_vec_rand<-runif(9, min=0, max=100)

# we add two NAs

ins <-c(NA,NA)
point <- which(order(c(ins,my_vec_rand))==3)
my_new_vec<-append(my_vec_rand, ins, point-1)
# Lets add infinity

ins_2<-Inf
my_new_vec<-append(my_new_vec, ins_2, point-2)
my_new_vec

# Lets check the length of the final vector (should be 12)

length(my_new_vec)

```
The range function


```{r}
# Range
# (1) Returns min and max from the input vector
     # if we have NAs then it will never give the result

range(my_new_vec)

# If we have infinity and other numbers(numeric) then use na.rm=TRUE
  # to suppress NA

range(my_new_vec,na.rm =TRUE)

# range in R - vectors with alphabetical data (character data)

x<-c("c","r","e","a","g","e","z")
range(x)

#create data frame

df <- data.frame(x=c(1, 3, NA, 5, 16, 18, 22, 29),
                 y=c(NA, 4, 8, 9, 14, 23, 29, 36),
                 z=c(2, NA, 9, 4, 13, 17, 22, 40))

#find range of all values in entire data frame

max(df, na.rm=TRUE) - min(df, na.rm=TRUE)
```






















